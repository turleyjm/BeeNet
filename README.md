# BeeNet: Reconstructing Flower Shapes from Electric Fields using Deep Learning

A deep learning framework for solving the inverse electrostatic imaging problem, enabling flower shape reconstruction directly from measured electric fields.

For the paper, see [arXiv](https://arxiv.org/abs/2508.11724).

## Installation

### Requirements

Install the required dependencies using:

```bash
pip install -r requirements.txt
```

### Project Structure

```
BeeNet/
├── trainingUNetPetal.ipynb      # Train U-Net model on electric field data
├── evaluateUNetPetal.ipynb      # Evaluate model predictions on test data
├── analysePetals.py             # Analyze petal mask predictions
├── assessPetals.py              # Assess petal reconstruction quality
├── makeDataSet.py               # Create training/validation/test datasets
├── convertData.py               # Data preprocessing utilities
├── requirements.txt             # Python dependencies
├── dat/                         # Dataset directory
│   ├── training/               # Training images and masks
│   ├── validation/             # Validation images and masks
│   └── testing/                # Testing images and masks
├── models/                      # Saved trained models
├── outputs/                     # Model predictions
└── results/                     # Analysis results
```

## Workflow

The complete workflow consists of three main stages:

### 1. Dataset Preparation

Prepare the electric field images and corresponding flower mask data:

```bash
python makeDataSet.py
```

This script organizes images into training, validation, and testing splits in the `dat/` directory.

### 2. Model Training

Train the U-Net model to learn the mapping from electric field patterns to flower shapes:

- Open `trainingUNetPetal.ipynb` in Jupyter
- Run all cells to train the model
- The trained model will be saved in the `models/` directory

The U-Net architecture learns to reconstruct flower geometries from electric field measurements generated by arthropod-flower interactions.

### 3. Model Evaluation

Evaluate the trained model on test data:

- Open `evaluateUNetPetal.ipynb` in Jupyter
- Run all cells to generate predictions on the test set
- Predictions are saved to the `outputs/` directory

### 4. Analysis

Analyze the reconstructed petal masks:

```bash
python analysePetals.py
python assessPetals.py
```

These scripts quantify reconstruction accuracy and assess the quality of predicted flower shapes across different geometries and arthropod-flower distances.

## Data

The dataset consists of:
- **Input**: Electric field images generated from simulated arthropod-flower interactions
- **Output**: Binary masks representing flower petal geometries

Electric fields are computed for varying petal geometries and arthropod distances to capture distance-dependent shape encoding.

The data can be found at [Zenodo](https://zenodo.org/records/16879470).

## Citation

If you use this code for your research, please cite:

```
Turley, Jake, et al. "BeeNet: Reconstructing Flower Shapes from Electric Fields using Deep Learning." arXiv preprint arXiv:2508.11724 (2025).
```
